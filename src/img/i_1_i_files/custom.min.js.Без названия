jQuery(function(s){function t(a){var i,t=a.parents(".p_img-first").siblings(".p_img-second").children(".la-lazyload-image"),e=a.parents(".product_item--inner").children(".variations_form").attr("current-image"),n=a.parents(".product_item--inner").children(".variations_form").data("product_variations");s.each(n,function(a,t){t.image_id!=e||(i=t.variation_gallery_images[1].url)}),background='url("'+i+'")',t.css("background-image",background),t.data("background-image",i)}function i(a){var t=s(".attribute-popup-overlay");t.on("click",function(){s(".formElementError").is(":visible")&&s(".formElementError").remove(),t.hide(),s(a).hide()}),s(".attribute-popup-cont").css("display","none"),s(a).hide(),t.show(),s(a).show(),s(a).find("a[name=close]").on("click",function(){s(".formElementError").is(":visible")&&s(".formElementError").remove(),t.hide(),s(a).hide()})}function n(){var a=s(".summary-inner .variations_form").find(".variations select"),i={},e=0,n=0;return a.each(function(){var a=s(this).data("attribute_name")||s(this).attr("name"),t=s(this).val()||"";0<t.length&&n++,e++,i[a]=t}),{count:e,chosenCount:n,data:i}}windowWidth=s(window).width(),s("li.product_item").each(function(a){s(this).find("img.wp-post-image").on("load",function(a){$wpPostImage=s(this),setTimeout(t($wpPostImage),500)})}),s("li.variable-item.image-variable-item").bind("click",function(){s(this).hasClass("selected")||s(this).addClass("selected")}),s("li.product_item").each(function(a){s(this).find("img.wp-post-image").on("load",function(a){$wpPostImage=s(this),setTimeout(t($wpPostImage),500)})}),s(document).ready(function(){s("li.image-variable-item").find(".show-text").text()&&(s("li.image-variable-item").css("margin-bottom","20px"),s(".show-text").css({bottom:"-30px",opacity:"1"})),s(".form-control ").parents(".wcpa_form_item").append('<div class="info-btn"><a href="https://www.diamondsmith.co.uk/ring-size/">Info</a></div>')}),s(document).ready(function(){var t,i,a;s(".single-product")&&(t=s("select#pa_mental-type").parents("tr"),i=t.clone(),a=s(".woo-variation-gallery-slider-wrapper .diamond-size-cont"),i.prependTo(a),i.find("select").on("change",function(a){t.find("select").val(this.value),t.find("select").trigger("change")}),t.find("select").on("change",function(a){i.find("select").val(this.value)}),s(window).on("load resize",function(){s(window).width()<800?(t.css({display:"none"}),i.css({display:"inline-table"})):(t.css({display:"table-row"}),i.css({display:"none"}))})),s(".video").click(function(){var a;videoId=s(this).parent().is("#package-video")?s(this).data("package"):(data=n(),material=data.data["attribute_pa_mental-type"],material.includes("rose")?s(this).data("rose"):material.includes("yellow")?s(this).data("yellow"):s(this).data("white")),videoId&&(s(".woo-variation-gallery-wrapper").addClass("loading-gallery"),a="https://embed.imajize.com/"+videoId,s(".videoIframe").attr("src",a),wrapperWidth=s(".woo-variation-gallery-slider").width(),s("#myIframe").css("height",wrapperWidth),setTimeout(function(){s("#myIframe").css("display","block"),s(".woo-variation-gallery-slider").css("visibility","hidden"),s("a.woo-variation-gallery-trigger").css("display","none")},600),s("iframe.videoIframe").load(function(){s(".woo-variation-gallery-wrapper").removeClass("loading-gallery")}))}),s("#back-gallery").on("click",function(){s(".woo-variation-gallery-slider").css({visibility:"visible"}),s("#myIframe").css({display:"none"}),s(".videoIframe").removeAttr("src"),s("a.woo-variation-gallery-trigger").css("display","block")})}),s(window).resize(function(){windowWidth!==s(window).width()&&(wrapperWidth=s("#myIframe").width(),s("#myIframe").css("height",wrapperWidth),windowWidth=s(window).width())}),s(".video-item").click(function(){s(this).addClass("active"),s(this).siblings().removeClass("active")}),s(".form-engraving").after('<a id="preview-btn" data-js="popup" data-id="engraving-popup">Preview</a>'),s(".form-engraving").attr("maxlength",30),s(document).ready(function(){s("[data-js=popup]").on("click",function(){var a=s(this).data("id");id=".attribute-popup-cont#"+a,i(id)})}),s(document).ready(function(){s(".form-engraving").bind("input propertychange",function(a){s(".form-engraving").val()?(i(".attribute-popup#engraving-popup"),function(a){var t=new Array,e="",n=(t=a.split("")).length,o=Math.ceil(n/2),i=s("#engraving-popup").width(),r=s("#engraving-popup").height();s("#engraving-popup span").width();s.each(t,function(a,t){var i;i=n%2==0?a-o:a+1-o,y=Math.cos(Math.abs(i)/10),translateY=r/2-10-31*y,(i<-3||3<i)&&y,e+='<span id= "text-'+a+'" data-index= "'+a+'" style="position: relative;margin: 0px;border: 0px;padding: 0px;overflow: visible;white-space: pre;display: block;visibility: visible;">'+t+"</span>"}),s("#engraving-popup.attribute-popup #engraving-text").html(e),s("#engraving-text span").each(function(){var a;leftPosition=s(this).position().left,z=Math.cos(Math.abs(i/2-leftPosition)/(i/2)),index=s(this).data("index")-o,translateY=r/2+23-46*z,a=index<-1?-.9*(1-z)+"rad":1<index?.9*(1-z)+"rad":0,css="translateY("+translateY+"px) rotate("+a+") skewX("+a+")",s(this).css("transform",css)})}(s(this).val())):s("#engraving-popup.attribute-popup span").remove()}),function(){var a=s("select#pa_carat"),t=s(".carat-comment-row[data-carat='"+a.val()+"']");""!=s(".carat-comment-row[data-carat='"+a.val()+"'] .carat-comment p").text()&&t.fadeIn("fast",function(){this.classList.add("active")});a.on("change",function(){!function(a){var t=s(".carat-comment-row.active"),i=s(".carat-comment-row[data-carat='"+a+"']"),e=s(".carat-comment-row.active .carat-comment p"),n=s(".carat-comment-row[data-carat='"+a+"'] .carat-comment p");""!=e.text()&&t.fadeOut("fast",function(){this.classList.remove("active"),""!=n.text()&&i.fadeIn("fast",function(){this.classList.add("active")})});t.length<=0&&""!=n.text()&&i.fadeIn("fast",function(){this.classList.add("active")})}(a.val())})}()}),s(".variations_form").change(function(a){data=n(),value=s(this).value;var t,i=data.count,e=data.chosenCount;material=data.data["attribute_pa_mental-type"],material&&(t=material,imgSrc="https://diamondsmith.co.uk/wp-content/"+t.toLowerCase()+".jpg",t&&s("#engraving-popup.attribute-popup").css("background-image","url("+imgSrc+")"),function(a){{var t;s(".woo-variation-gallery-wrapper").addClass("loading-gallery"),$this=s(".video-item.active").children(".video"),"package-video"!==$this.parent().attr("id")&&(videoId=a.includes("rose")?$this.data("rose"):a.includes("yellow")?$this.data("yellow"):$this.data("white"),videoId&&(t="https://embed.imajize.com/"+videoId,s(".videoIframe").attr("src",t)),s(".woo-variation-gallery-wrapper").removeClass("loading-gallery"))}}(material)),i==e&&s("input.variation_id").val()}),s(".variations_form").on("show_variation",function(a,t){var i=s(t.price_html).find("bdi").text().substring(1,s(t.price_html).find("bdi").text().length).replace(",",""),i=parseFloat(i),e=s("#street-price .percentage").text(),e=parseFloat(e/100),n=Math.round(100*(i/(1-e)-i))/100;s("#street-price .price").text(n)})});