var gtm4wp_changedetail_fired_during_pageload=!1,gtm4wp_last_selected_product_variation;function gtm4wp_handle_cart_qty_change(){jQuery('.product-quantity input.qty').each(function(){var d=jQuery(this).prop('defaultValue'),c=parseInt(jQuery(this).val()),a,b;Number.isNaN(c)&&(c=d),d!=c&&(a=jQuery(this).closest('.cart_item').find('.remove'),b=a.data('gtm4wp_product_price'),typeof b=="string"?(b=parseFloat(b),isNaN(b)&&(b=0)):typeof b!="number"&&(b=0),d<c?window[gtm4wp_datalayer_name].push({event:'gtm4wp.addProductToCartEEC',ecommerce:{currencyCode:gtm4wp_currency,add:{products:[{name:a.data('gtm4wp_product_name'),id:a.data('gtm4wp_product_id'),price:b.toFixed(2),category:a.data('gtm4wp_product_cat'),variant:a.data('gtm4wp_product_variant'),stocklevel:a.data('gtm4wp_product_stocklevel'),brand:a.data('gtm4wp_product_brand'),quantity:c-d}]}}}):window[gtm4wp_datalayer_name].push({event:'gtm4wp.removeFromCartEEC',ecommerce:{currencyCode:gtm4wp_currency,remove:{products:[{name:a.data('gtm4wp_product_name'),id:a.data('gtm4wp_product_id'),price:b.toFixed(2),category:a.data('gtm4wp_product_cat'),variant:a.data('gtm4wp_product_variant'),stocklevel:a.data('gtm4wp_product_stocklevel'),brand:a.data('gtm4wp_product_brand'),quantity:d-c}]}}}))})}jQuery(function(){var h=jQuery('body').hasClass('woocommerce-cart'),i=jQuery('body').hasClass('woocommerce-checkout'),e,b,c,g,a,f,d;if(jQuery('.gtm4wp_productdata,.widget-product-item').length>0)if(e=[],c=0,jQuery('.gtm4wp_productdata,.widget-product-item').each(function(){b=jQuery(this),c=b.data('gtm4wp_product_price'),typeof c=="string"?(c=parseFloat(c),isNaN(c)&&(c=0)):typeof c!="number"&&(c=0),e.push({name:b.data('gtm4wp_product_name'),id:b.data('gtm4wp_product_id'),price:c.toFixed(2),category:b.data('gtm4wp_product_cat'),position:b.data('gtm4wp_product_listposition'),list:b.data('gtm4wp_productlist_name'),stocklevel:b.data('gtm4wp_product_stocklevel'),brand:b.data('gtm4wp_product_brand')})}),gtm4wp_product_per_impression>0)while(e.length)g=e.splice(0,gtm4wp_product_per_impression),window[gtm4wp_datalayer_name].push({event:'gtm4wp.productImpressionEEC',ecommerce:{currencyCode:gtm4wp_currency,impressions:g}});else{for(a=0;a<window[gtm4wp_datalayer_name].length;a++)if(window[gtm4wp_datalayer_name][a].ecommerce){window[gtm4wp_datalayer_name][a].ecommerce.impressions?window[gtm4wp_datalayer_name][a].ecommerce.impressions=window[gtm4wp_datalayer_name][a].ecommerce.impressions.concat(e):window[gtm4wp_datalayer_name][a].ecommerce.impressions=e;break}a==window[gtm4wp_datalayer_name].length&&(a=0,window[gtm4wp_datalayer_name][a].ecommerce={},window[gtm4wp_datalayer_name][a].ecommerce.impressions=e),window[gtm4wp_datalayer_name][a].ecommerce.currencyCode=gtm4wp_currency}if(jQuery(document).on('click','.add_to_cart_button:not(.product_type_variable, .product_type_grouped, .single_add_to_cart_button)',function(){var b=jQuery(this).closest('.product').find('.gtm4wp_productdata'),a=b.data('gtm4wp_product_price');typeof a=="string"?(a=parseFloat(a),isNaN(a)&&(a=0)):typeof a!="number"&&(a=0),window[gtm4wp_datalayer_name].push({event:'gtm4wp.addProductToCartEEC',ecommerce:{currencyCode:gtm4wp_currency,add:{products:[{name:b.data('gtm4wp_product_name'),id:b.data('gtm4wp_product_id'),price:a.toFixed(2),category:b.data('gtm4wp_product_cat'),stocklevel:b.data('gtm4wp_product_stocklevel'),brand:b.data('gtm4wp_product_brand'),quantity:1}]}}})}),jQuery(document).on('click','.single_add_to_cart_button:not(.disabled)',function(){var a=jQuery(this).closest('form.cart'),c=jQuery('[name=variation_id]',a),d=jQuery(a).hasClass('grouped_form'),e,b;if(c.length>0)gtm4wp_last_selected_product_variation&&(gtm4wp_last_selected_product_variation.quantity=jQuery('form.cart:first input[name=quantity]').val(),window[gtm4wp_datalayer_name].push({event:'gtm4wp.addProductToCartEEC',ecommerce:{currencyCode:gtm4wp_currency,add:{products:[gtm4wp_last_selected_product_variation]}}}));else if(d){if(e=jQuery('.grouped_form .gtm4wp_productdata'),b=[],e.each(function(){var a=jQuery(this),c=jQuery('input[name=quantity\\['+a.data('gtm4wp_product_id')+'\\]]');if(c.length>0)product_qty=c.val();else return;if(0==product_qty)return;b.push({id:gtm4wp_use_sku_instead?a.data('gtm4wp_product_sku'):a.data('gtm4wp_product_id'),name:a.data('gtm4wp_product_name'),price:a.data('gtm4wp_product_price'),category:a.data('gtm4wp_product_cat'),quantity:product_qty,stocklevel:a.data('gtm4wp_product_stocklevel'),brand:a.data('gtm4wp_product_brand')})}),0==b.length)return;window[gtm4wp_datalayer_name].push({event:'gtm4wp.addProductToCartEEC',ecommerce:{currencyCode:gtm4wp_currency,add:{products:b}}})}else window[gtm4wp_datalayer_name].push({event:'gtm4wp.addProductToCartEEC',ecommerce:{currencyCode:gtm4wp_currency,add:{products:[{id:gtm4wp_use_sku_instead?jQuery('[name=gtm4wp_sku]',a).val():jQuery('[name=gtm4wp_id]',a).val(),name:jQuery('[name=gtm4wp_name]',a).val(),price:jQuery('[name=gtm4wp_price]',a).val(),category:jQuery('[name=gtm4wp_category]',a).val(),quantity:jQuery('form.cart:first input[name=quantity]').val(),stocklevel:jQuery('[name=gtm4wp_stocklevel]',a).val(),brand:jQuery('[name=gtm4wp_brand]',a).val()}]}}})}),jQuery(document).on('click','.mini_cart_item a.remove,.product-remove a.remove',function(){var a=jQuery(this),b=0,c=jQuery(this).closest('.cart_item').find('.product-quantity input.qty');if(c.length===0?(c=jQuery(this).closest('.mini_cart_item').find('.quantity'),c.length>0&&(b=parseInt(c.text()),Number.isNaN(b)&&(b=0))):b=c.val(),b===0)return!0;window[gtm4wp_datalayer_name].push({event:'gtm4wp.removeFromCartEEC',ecommerce:{remove:{products:[{name:a.data('gtm4wp_product_name'),id:a.data('gtm4wp_product_id'),price:a.data('gtm4wp_product_price'),category:a.data('gtm4wp_product_cat'),variant:a.data('gtm4wp_product_variant'),stocklevel:a.data('gtm4wp_product_stocklevel'),brand:a.data('gtm4wp_product_brand'),quantity:b}]}}})}),jQuery(document).on('click','.products li:not(.product-category) a:not(.add_to_cart_button):not(.quick-view-button),.products>div:not(.product-category) a:not(.add_to_cart_button):not(.quick-view-button),.widget-product-item,.woocommerce-grouped-product-list-item__label a',function(c){var b,a,d,e;if('undefined'==typeof google_tag_manager)return!0;if(b=jQuery(this).closest('.product'),a='',b.length>0?a=b.find('.gtm4wp_productdata'):(b=jQuery(this).closest('.products li'),b.length>0?a=b.find('.gtm4wp_productdata'):(b=jQuery(this).closest('.products>div'),b.length>0?a=b.find('.gtm4wp_productdata'):(b=jQuery(this).closest('.woocommerce-grouped-product-list-item__label'),b.length>0?a=b.find('.gtm4wp_productdata'):a=jQuery(this)))),'undefined'==typeof a.data('gtm4wp_product_id')||''==a.data('gtm4wp_product_id'))return!0;if(a.data('gtm4wp_product_url')!=jQuery(this).attr('href'))return!0;d=c.ctrlKey||c.metaKey,c.preventDefault(),d&&(e=window.open('about:blank','_blank')),window[gtm4wp_datalayer_name].push({event:'gtm4wp.productClickEEC',ecommerce:{currencyCode:gtm4wp_currency,click:{actionField:{list:a.data('gtm4wp_productlist_name')},products:[{id:a.data('gtm4wp_product_id'),name:a.data('gtm4wp_product_name'),price:a.data('gtm4wp_product_price'),category:a.data('gtm4wp_product_cat'),stocklevel:a.data('gtm4wp_product_stocklevel'),brand:a.data('gtm4wp_product_brand'),position:a.data('gtm4wp_product_listposition')}]}},eventCallback:function(){d&&e?e.location.href=a.data('gtm4wp_product_url'):document.location.href=a.data('gtm4wp_product_url')},eventTimeout:2e3})}),jQuery(document).on('found_variation',function(n,c){var a,m,l,f,k,h,j,e,g,b,d,i;if("undefined"==typeof c)return;if(document.readyState==="interactive"&&gtm4wp_changedetail_fired_during_pageload)return;a=n.target,m=jQuery('[name=variation_id]',a),l=jQuery('[name=gtm4wp_id]',a).val(),f=jQuery('[name=gtm4wp_name]',a).val(),k=jQuery('[name=gtm4wp_sku]',a).val(),h=jQuery('[name=gtm4wp_category]',a).val(),j=jQuery('[name=gtm4wp_price]',a).val(),e=jQuery('[name=gtm4wp_stocklevel]',a).val(),g=jQuery('[name=gtm4wp_brand]',a).val(),b={name:f,id:0,price:0,category:h,stocklevel:e,brand:g,variant:''},b.id=c.variation_id,gtm4wp_use_sku_instead&&c.sku&&''!==c.sku&&(b.id=c.sku),b.price=c.display_price,d=[];for(i in c.attributes)d.push(c.attributes[i]);b.variant=d.join(','),gtm4wp_last_selected_product_variation=b,window[gtm4wp_datalayer_name].push({event:'gtm4wp.changeDetailViewEEC',ecommerce:{currencyCode:gtm4wp_currency,detail:{products:[b]}},ecomm_prodid:gtm4wp_id_prefix+b.id,ecomm_pagetype:'product',ecomm_totalvalue:b.price}),document.readyState==="interactive"&&(gtm4wp_changedetail_fired_during_pageload=!0)}),jQuery('.variations select').trigger('change'),jQuery(document).ajaxSuccess(function(b,c,a){typeof a!='undefined'&&a.url.indexOf('wc-api=WC_Quick_View')>-1&&setTimeout(function(){jQuery(".woocommerce.quick-view").parent().find("script").each(function(a){eval(jQuery(this).text())})},500)}),h&&(jQuery(document).on('click','[name=update_cart]',function(){gtm4wp_handle_cart_qty_change()}),jQuery(document).on('keypress','.woocommerce-cart-form input[type=number]',function(){gtm4wp_handle_cart_qty_change()})),i&&(window.gtm4wp_checkout_step_offset=window.gtm4wp_checkout_step_offset||0,window.gtm4wp_checkout_products=window.gtm4wp_checkout_products||[],f=window.gtm4wp_needs_shipping_address?0:-1,d=[],jQuery(document).on('blur','input[name^=shipping_]:not(input[name^=shipping_method])',function(){if(d.indexOf('shipping')>-1)return;if(jQuery(this).val().trim()=='')return;window[gtm4wp_datalayer_name].push({event:'gtm4wp.checkoutStepEEC',ecommerce:{checkout:{actionField:{step:2+window.gtm4wp_checkout_step_offset},products:window.gtm4wp_checkout_products}}}),d.push('shipping')}),jQuery(document).on('change','input[name^=shipping_method]',function(){if(d.indexOf('shipping_method')>-1)return;if('complete'!=document.readyState)return;window[gtm4wp_datalayer_name].push({event:'gtm4wp.checkoutStepEEC',ecommerce:{checkout:{actionField:{step:3+window.gtm4wp_checkout_step_offset+f},products:window.gtm4wp_checkout_products}}}),d.push('shipping_method')}),jQuery(document).on('change','input[name=payment_method]',function(){if(d.indexOf('payment_method')>-1)return;if('complete'!=document.readyState)return;window[gtm4wp_datalayer_name].push({event:'gtm4wp.checkoutStepEEC',ecommerce:{checkout:{actionField:{step:4+window.gtm4wp_checkout_step_offset+f},products:window.gtm4wp_checkout_products}}}),d.push('payment_method')}),jQuery('form[name=checkout]').on('submit',function(){var a,b,c;d.indexOf('shipping_method')==-1&&(a=jQuery('input[name^=shipping_method]:checked'),a.length==0&&(a=jQuery('input[name^=shipping_method]:first')),a.length>0&&a.trigger('change')),d.indexOf('payment_method')==-1&&jQuery('input[name=payment_method]:checked').trigger('change'),b=jQuery('input[name^=shipping_method]:checked'),b.length==0&&(b=jQuery('input[name^=shipping_method]:first')),b.length>0&&window[gtm4wp_datalayer_name].push({event:'gtm4wp.checkoutOptionEEC',ecommerce:{checkout_option:{actionField:{step:3+window.gtm4wp_checkout_step_offset+f,option:'Shipping: '+b.val()}}}}),c=jQuery('.payment_methods input:checked'),c.length>0&&window[gtm4wp_datalayer_name].push({event:'gtm4wp.checkoutOptionEEC',ecommerce:{checkout_option:{actionField:{step:4+window.gtm4wp_checkout_step_offset+f,option:'Payment: '+c.val()}}}})})),window.gtm4wp_remarketing&&!h&&!i){if(jQuery('.gtm4wp_productdata').length>0){for(a=0;a<window[gtm4wp_datalayer_name].length;a++)if(window[gtm4wp_datalayer_name][a].ecomm_prodid)break;if(a==window[gtm4wp_datalayer_name].length&&(a=0,window[gtm4wp_datalayer_name][a].ecomm_prodid=[]),'undefined'==typeof window[gtm4wp_datalayer_name][a].ecomm_prodid.push)return!1;jQuery('.gtm4wp_productdata').each(function(){b=jQuery(this),window[gtm4wp_datalayer_name][a].ecomm_prodid.push(gtm4wp_id_prefix+b.data('gtm4wp_product_id'))})}}})